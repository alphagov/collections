<%
  main_classes = %w[content]
  main_classes << (yield :page_class)
  lang = params["locale"]

  if content_item_h
    unless (!content_item_h["locale"])
      lang = content_item_h["locale"]
    end
  end
%>

<%= content_for :head do %>
  <%= csrf_meta_tags %>
  <%= yield :meta_tags %>
  <% if show_app_promo_banner? %>
    <meta name="apple-itunes-app" content="app-id=6572293285">
  <% end %>
  <%= render 'govuk_publishing_components/components/meta_tags', content_item: content_item_h %>

  <%= javascript_include_tag "test-dependencies", type: "module" if Rails.env.test? %>
<% end %>

<%= render "govuk_publishing_components/components/layout_for_public", {
    title: "#{yield :title} - #{ t('application.title.suffix') }",
    emergency_banner: render("govuk_web_banners/emergency_banner"),
    global_banner: render("govuk_web_banners/global_banner"),
    show_app_promo_banner: show_app_promo_banner?,
  } do %>
    <%= content_tag(:div, class: class_names("govuk-width-container" => !@full_width)) do %>
      <%= yield :back_link %>
      <% unless content_for(:back_link) %>
        <% if content_for?(:breadcrumbs) %>
          <%= yield :breadcrumbs %>
        <% else %>
          <%= render 'breadcrumbs' %>
        <% end %>
      <% end %>
      <% if content_for?(:recruitment_banner) %>
        <%= yield :recruitment_banner %>
      <% end %>
      <%= content_tag(:main, id: "content", role: "main", class: main_classes, lang: lang) do %>
        <%= yield %>
      <% end %>
    <% end %>
<% end %>
